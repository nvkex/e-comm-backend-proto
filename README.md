# E-Commerce API

## Disclaimer
*This API can be used to perform all types of operations related to an e-commerce website*

- Authentication
    - [Login](#1-login)
    - [Signup](#2-signup)
- Admin
    - [Get Login/Signup History](#3-get-authentication-history-admin)
    - [Get Buy/Sell History](#3-get-transaction-history-admin)
- User
    - [Buy Product](#4-buy-product)

## Base URL
`N/A`

## Routes
### 1. Login
**Method** :  `POST`

**URL** : `<Base URL>/auth/login`

**Auth Required** : `false`

#### Body :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `email` | User email | No | `String` |
| `password` | User password | No | `String` |


#### Response Data :
```ts
{
    // User data
    "user" : [Object]
}
```
#### Response Header :
```ts
{
    // Authorization Token
    "auth-token" : [String]
}
```

#### Errors :
- Unregistered user tries to login.
```ts
{
    "error" : "User doesnt exist"
}
```
- Incorrect password.
```ts
{
    "error" : "Invalid Password"
}
```


### 2. Signup
**Method** :  `POST`

**URL** : `<Base URL>/auth/signup`

**Auth Required** : `false`

#### Body :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `email` | User email | No | `String` |
| `password` | User password | No | `String` |
| `name` | User's name | No | `String` |


#### Response Data :
```ts
{
    // On successful signup
    "msg" : [String]
    // On signup failure
    "error": [String]
}
```
*Note : A welcome mail will be sent to the user on successful signup.*

#### Errors :
- Existing user signs up.
```ts
{
    "error" : "Email already exists"
}
```
- Other errors
```ts
{
    // Error generated by NodeJS/MongoDB
    "error" : [Object]
}
```


### 3. Get Authentication History (Admin)
**Method** :  `GET`

**URL** : `<Base URL>/admin/auth-history`

**Auth Required** : `true`

**User Role** : `Admin`

#### Request Header :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `x-access-token` | Auth Token | No | `String` |


#### Response Data :
```ts
{
    // Authentication history
    "data" : {
        "date" : [Date],
        "history" : [Array]
    }
}
```

#### Errors :
- When user has not logged in or is not an admin.
```ts
{
    "message" : "Unauthorized"
}
```
- Other errors
```ts
{
    // Error generated by NodeJS/MongoDB
    "message" : [Object]
}
```

### 3. Get Transaction History (Admin)
**Method** :  `GET`

**URL** : `<Base URL>/admin/transaction-history`

**Auth Required** : `true`

**User Role** : `Admin`

#### Request Header :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `x-access-token` | Auth Token | No | `String` |


#### Response Data :
```ts
{
    // Buy & Sell transaction history
    "data" : [Object]
}
```

#### Errors :
- When user has not logged in or is not an admin.
```ts
{
    "message" : "Unauthorized"
}
```
- Other errors
```ts
{
    // Error generated by NodeJS/MongoDB
    "message" : [Object]
}
```

### 4. Buy Product
**Method** :  `POST`

**URL** : `<Base URL>/user/buy`

**Auth Required** : `true`

#### Request Header :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `x-access-token` | Auth Token | No | `String` |

#### Request Body :
| Key | Description | Optional | Type |
| ------------ | ------------ | ------------ | ------------ |
| `productId` | Product ID | No | `ObjectID` |
| `coupon` | Coupon Code | Yes | `String` |
| `sender.id` | Buyer's ID | No | `ObjectID` |
| `sender.name` | Buyer's name | No | `String` |
| `sender.email` | Buyer's email | No | `String` |
| `sender.location` | Buyer's Location | Yes | `Co-ordinates` |
| `recipient.id` | Seller's ID | No | `ObjectID` |
| `recipient.name` | Seller's name | No | `String` |
| `recipient.email` | Seller's email | No | `String` |
| `recipient.location` | Seller's Location | Yes | `Co-ordinates` |


#### Response Data :
```ts
{
    // Transaction Date
    "date" : [Date],
    // Coupon code
    "coupon" : [String],
    // Transaction status
    "success" : [Boolean],
    // Product ID
    "productId" : [ObjectID],
    // Buyer's Info
    "sender": {
        "id": [ObjectID],
        "name": [String],
        "email": [String]
    },
    // Seller's Info
    "recipient": {
        "id": [ObjectID],
        "name": [String],
        "email": [String]
    },
    // Transaction ID
    "id": [ObjectID],
    // Trnasaction Type
    "transactionType": [String],
}
```

#### Errors :
- If auth token is not provided in header.
```ts
{
    "message" : "No token provided!"
}
```

- If user has not logged in.
```ts
{
    "message" : "Unauthorized"
}
```

- Other errors
```ts
{
    // Error generated by NodeJS/MongoDB
    "message" : [Object]
}
```



### Error Responses

Code : `400 Bad Request`

Content : Mongoose error is shown, with suggestions to fix the query.



